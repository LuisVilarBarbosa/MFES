class Conversation
types
	public static Users = set1 of User;
	public static Message ::
		date : Common`Date
		text : Common`String1
		sender : User;
	public static Messages = inmap nat1 to Message;
values
-- TODO Define values here
instance variables
	-- Variables declared public to facilitate queries
	public members : Users;
	public topic : Common`String1;
	public messages : Messages := { |-> };
operations
	public Conversation : Common`String1 * Users ==> Conversation
	Conversation(t, users) == (
		topic := t;
		members := users;
		for all user in set members do
			user.AddConversation(self);
	)
	pre card users > 1
	post members = users and topic = t; -- and forall user in set members & user.GetConversations() inter {self} = {self};

	public AddMember : User ==> ()
	AddMember(u) == (
		members := members union {u};
	)
	pre members inter {u} = {}
	post members inter {u} = {u};
	
	public RemoveMember : User ==> ()
	RemoveMember(u) == (
		members := members \ {u};
	)
	pre members inter {u} = {u}
	post members inter {u} = {};

	public SetTopic : Common`String1 ==> ()
	SetTopic(t) == (
		topic := t;
	);
	--pre
	--post;

	public AddMessage : Common`Date * Common`String1 * User ==> ()
	AddMessage(d,t,s) == (
		dcl msg : Message := mk_Message(d,t,s);
		dcl myMap : Messages := { card dom messages |-> msg };
		messages := messages munion myMap;
	);
	--pre
	--post
functions
-- TODO Define functiones here
traces
-- TODO Define Combinatorial Test Traces here
end Conversation